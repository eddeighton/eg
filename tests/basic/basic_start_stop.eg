
dim int counter;

action A[ 4 ]
{
    action B[ 4 ]
    {
        SLEEP_S( 0.2 );
        counter( counter() + 1 );
        
        action D[ 4 ]
        {
            SLEEP_S( 0.2 );
            counter( counter() + 1 );
            
            action F[ 4 ]
            {
                SLEEP_S( 0.2 );
                counter( counter() + 1 );
            }
            while( F.Size() )
                SLEEP;
        }
        while( D.Size() )
            SLEEP;
    }
    
    action C[ 4 ]
    {
        SLEEP_S( 0.2 );
        counter( counter() + 1 );
        
        action E[ 4 ]
        {
            SLEEP_S( 0.2 );
            counter( counter() + 1 );
        }
        while( E.Size() )
            SLEEP;
    }
    
    while( B.Size() || C.Size() )
        SLEEP;
}

counter( 0 );

A a = A();
A::B b = a.B();
A::B::D d = b.D();
d.F();

A::C c = a.C();
A::C::E e = c.E();

SLEEP_UNTIL( a );

TEST( counter() == 5 );

