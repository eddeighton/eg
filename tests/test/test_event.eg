
action A[ 4 ]
{
    eg::sleep();
    std::cout << "A finishing: " << clock::cycle() << std::endl;
}
action B
{
    eg::sleep();
    std::cout << "B finishing: " << clock::cycle() << std::endl;
}

A a = A();

eg::sleep( a );
std::cout << "Got a" << std::endl;

action Test
{
    eg::sleep
    (
        eg::fiber_props::ResumptionFunctor
        (
            [ this ]( Event e )
            {
                return B.Get() == e;
            }
        )
    );
    std::cout << "Test worked" << std::endl;
}

B.Start();
Test.Start();

a = A.Start();

eg::sleep
( 
    eg::fiber_props::ResumptionFunctor
    (
        [ a ]( Event e )
        { 
            return a == e;
        } 
    )
);

std::cout << "Got a again" << std::endl;